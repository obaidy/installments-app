(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[280],{897:function(e,t,r){Promise.resolve().then(r.bind(r,795))},795:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(7437),a=r(2265),l=r(2183),s=r(361),d=r(5057),i=r(8935),o=r(1700),c=r(7003);function u(){let[e,t]=(0,a.useState)(""),[r,u]=(0,a.useState)([]),[m,b]=(0,a.useState)("all"),[p,x]=(0,a.useState)(!0),[g,h]=(0,a.useState)(0),[y,f]=(0,a.useState)(!1),[j,k]=(0,a.useState)({});async function S(e){x(!0);let t=50*e,{data:r}=await i.O.from("payments").select("id, amount, status, paid_at, units(name)").order("paid_at",{ascending:!1}).range(t,t+50-1),n=(r||[]).map(e=>{var t;return{id:e.id,unit:(null===(t=e.units)||void 0===t?void 0:t.name)||"-",amount:e.amount,status:e.status,paidAt:e.paid_at}});u(n),f(50===n.length),x(!1)}(0,a.useEffect)(()=>{S(g)},[g]);let N=(0,a.useMemo)(()=>{let t=e.toLowerCase().trim(),n=r;return"all"!==m&&(n=n.filter(e=>e.status===m)),t&&(n=n.filter(e=>e.unit.toLowerCase().includes(t))),n},[r,e,m]),v=(0,a.useMemo)(()=>N.filter(e=>j[String(e.id)]),[N,j]);return(0,n.jsx)(l.N,{children:(0,n.jsxs)("main",{className:"p-6 space-y-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:"Payments"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{className:"px-3 py-1.5 rounded-md border border-border "+("all"===m?"bg-muted/30":""),onClick:()=>b("all"),children:"All"}),(0,n.jsx)("button",{className:"px-3 py-1.5 rounded-md border border-border "+("paid"===m?"bg-muted/30":""),onClick:()=>b("paid"),children:"Paid"}),(0,n.jsx)("button",{className:"px-3 py-1.5 rounded-md border border-border "+("pending"===m?"bg-muted/30":""),onClick:()=>b("pending"),children:"Pending"}),(0,n.jsx)("button",{className:"px-3 py-1.5 rounded-md border border-border "+("failed"===m?"bg-muted/30":""),onClick:()=>b("failed"),children:"Failed"}),(0,n.jsx)("button",{className:"px-3 py-1.5 rounded-md border border-border "+("cancelled"===m?"bg-muted/30":""),onClick:()=>b("cancelled"),children:"Cancelled"})]}),(0,n.jsx)(s.o,{query:e,setQuery:t,onSearch:()=>{},right:(0,n.jsx)(o.j,{filename:"payments.csv",columns:[{key:"unit",label:"Unit"},{key:"amount",label:"Amount"},{key:"status",label:"Status"},{key:"paidAt",label:"Paid At"}],rows:v.length?v:N})}),(0,n.jsx)(d.w,{columns:[{key:"unit",label:"Unit"},{key:"amount",label:"Amount",render:e=>(0,c.y)(e.amount,"en-IQ")},{key:"status",label:"Status",render:e=>(0,n.jsx)("span",{className:"px-2 py-0.5 rounded-full border text-xs "+("paid"===e.status?"bg-green-100 text-green-700 border-green-200":"pending"===e.status?"bg-yellow-100 text-yellow-800 border-yellow-200":"failed"===e.status?"bg-red-100 text-red-700 border-red-200":"bg-gray-100 text-gray-700 border-gray-200"),children:e.status.toUpperCase()})},{key:"paidAt",label:"Paid At",render:e=>e.paidAt?(0,c.p)(e.paidAt,"en-IQ"):"-"}],rows:N,selectable:!0,selected:j,onToggleRow:e=>k(t=>({...t,[String(e.id)]:!t[String(e.id)]})),onToggleAll:e=>{let t={};e&&N.forEach(e=>t[String(e.id)]=!0),k(t)}}),(0,n.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-3",children:[(0,n.jsx)("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:0===g,onClick:()=>h(e=>Math.max(0,e-1)),children:"Prev"}),(0,n.jsx)("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:!y,onClick:()=>h(e=>e+1),children:"Next"})]}),p?(0,n.jsx)("div",{className:"mt-2 text-sm opacity-70",children:"Loading…"}):null]})})}},5057:function(e,t,r){"use strict";r.d(t,{w:function(){return l}});var n=r(7437),a=r(2265);function l(e){let{columns:t,rows:r,selectable:l,selected:s,onToggleRow:d,onToggleAll:i}=e,[o,c]=(0,a.useState)(null),[u,m]=(0,a.useState)("asc"),b=(0,a.useMemo)(()=>{if(!o)return r;let e=[...r];return e.sort((e,t)=>{let r=e[o],n=t[o];return r<n?"asc"===u?-1:1:r>n?"asc"===u?1:-1:0}),e},[r,o,u]),p=e=>{let{active:t}=e;return(0,n.jsx)("span",{className:"ml-1 text-xs opacity-70",children:t?"asc"===u?"↑":"↓":"↕"})},x=l&&s&&r.length>0&&r.every(e=>s[String(e.id)]);return l&&s&&r.some(e=>s[String(e.id)]),(0,n.jsx)("div",{className:"overflow-x-auto rounded-lg border border-border",children:(0,n.jsxs)("table",{className:"min-w-full text-sm",children:[(0,n.jsx)("thead",{className:"bg-muted/40 sticky top-0 z-10 backdrop-blur",children:(0,n.jsxs)("tr",{children:[l?(0,n.jsx)("th",{className:"p-3 w-[42px]",children:(0,n.jsx)("input",{type:"checkbox","aria-label":"Select all rows",checked:!!x,onChange:e=>null==i?void 0:i(e.target.checked)})}):null,t.map(e=>(0,n.jsxs)("th",{className:"text-left p-3 cursor-pointer select-none",style:{width:e.width},onClick:()=>{var t;o===(t=e.key)?m(e=>"asc"===e?"desc":"asc"):(c(t),m("asc"))},children:[e.label,(0,n.jsx)(p,{active:o===e.key})]},String(e.key)))]})}),(0,n.jsx)("tbody",{className:"bg-card",children:b.map((e,r)=>(0,n.jsxs)("tr",{className:"border-t border-border transition-colors "+(r%2==1?"bg-muted/10 ":"")+(l&&s&&s[String(e.id)]?" bg-primary/5 ":"")+"hover:bg-muted/20",children:[l?(0,n.jsx)("td",{className:"p-3 w-[42px]",children:(0,n.jsx)("input",{type:"checkbox","aria-label":"Select row ".concat(String(e.id)),checked:!!(null==s?void 0:s[String(e.id)]),onChange:()=>null==d?void 0:d(e)})}):null,t.map(t=>(0,n.jsx)("td",{className:"p-3",children:t.render?t.render(e):e[t.key]},String(t.key)))]},String(e.id)))})]})})}},1700:function(e,t,r){"use strict";r.d(t,{j:function(){return a}});var n=r(7437);function a(e){let{filename:t,columns:r,rows:a}=e;return(0,n.jsx)("button",{className:"rounded-md border border-border px-3 py-2 text-sm",onClick:function(){let e=new Blob([r.map(e=>l(String(e.label))).join(",")+"\n"+a.map(e=>r.map(t=>{var r;return l(null==(r=e[t.key])?"":r instanceof Date?r.toISOString():String(r))}).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(e),s=document.createElement("a");s.href=n,s.download=t,s.click(),URL.revokeObjectURL(n)},title:"Export CSV",children:"Export CSV"})}function l(e){return e.includes(",")||e.includes('"')||e.includes("\n")?'"'+e.replace(/"/g,'""')+'"':e}r(2265)},361:function(e,t,r){"use strict";r.d(t,{o:function(){return a}});var n=r(7437);function a(e){let{query:t,setQuery:r,onSearch:a,right:l}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,n.jsx)("input",{className:"w-full md:w-auto flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"Search…",value:t,onChange:e=>r(e.target.value)}),(0,n.jsx)("button",{className:"rounded-md bg-primary text-primaryForeground px-3 py-2 text-sm",onClick:a,children:"Search"}),l]})}r(2265)},7003:function(e,t,r){"use strict";function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-IQ";return new Intl.NumberFormat(t,{style:"currency",currency:"IQD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ar-IQ",r="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat(t,{year:"numeric",month:"2-digit",day:"2-digit",timeZone:"UTC"}).format(r)}r.d(t,{p:function(){return a},y:function(){return n}})}},function(e){e.O(0,[598,138,183,971,23,744],function(){return e(e.s=897)}),_N_E=e.O()}]);
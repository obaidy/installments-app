(()=>{var e={};e.id=46,e.ids=[46],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},2703:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),r(9661),r(5866),r(5252);var s=r(3191),n=r(8716),a=r(7922),i=r.n(a),l=r(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(t,d);let o=["",{children:["(routes)",{children:["installments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9661)),"C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\(routes)\\installments\\page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,5252)),"C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\(routes)\\installments\\page.tsx"],u="/(routes)/installments/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(routes)/installments/page",pathname:"/installments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},4335:(e,t,r)=>{Promise.resolve().then(r.bind(r,4204))},4204:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(326),n=r(7577),a=r(9748),i=r(3971),l=r(6855),d=r(3055),o=r(8131),c=r(72);function u(){let[e,t]=(0,n.useState)(""),[r,u]=(0,n.useState)([]),[p,m]=(0,n.useState)("all"),[x,b]=(0,n.useState)(!0),[g,h]=(0,n.useState)(0),[y,j]=(0,n.useState)(!1),[f,k]=(0,n.useState)({}),S=(0,n.useMemo)(()=>{let t=e.toLowerCase().trim(),s=r;return"all"!==p&&(s=s.filter(e=>e.status===p)),t&&(s=s.filter(e=>e.unit.toLowerCase().includes(t))),s},[r,e,p]),v=(0,n.useMemo)(()=>S.filter(e=>f[String(e.id)]),[S,f]);async function w(e){await d.O.from("installments").update({paid:!0,paid_at:new Date().toISOString()}).eq("id",e),u(t=>t.map(t=>t.id===e?{...t,status:"paid"}:t))}async function N(){let e=v.map(e=>e.id);0!==e.length&&(await d.O.from("installments").update({paid:!0,paid_at:new Date().toISOString()}).in("id",e),u(t=>t.map(t=>e.includes(t.id)?{...t,status:"paid"}:t)),k({}))}return s.jsx(a.N,{children:(0,s.jsxs)("main",{className:"p-6 space-y-4",children:[s.jsx("h1",{className:"text-2xl font-semibold",children:"Installments"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border "+("all"===p?"bg-muted/30":""),onClick:()=>m("all"),children:"All"}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border "+("due"===p?"bg-muted/30":""),onClick:()=>m("due"),children:"Due"}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border "+("overdue"===p?"bg-muted/30":""),onClick:()=>m("overdue"),children:"Past Due"}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border "+("paid"===p?"bg-muted/30":""),onClick:()=>m("paid"),children:"Paid"})]}),s.jsx(i.o,{query:e,setQuery:t,onSearch:()=>{},right:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(o.j,{filename:"installments.csv",columns:[{key:"unit",label:"Unit"},{key:"dueDate",label:"Due"},{key:"amount",label:"Amount"},{key:"status",label:"Status"}],rows:v.length?v:S}),(0,s.jsxs)("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:0===v.length,onClick:N,children:["Mark Paid (",v.length,")"]})]})}),s.jsx(l.w,{columns:[{key:"unit",label:"Unit"},{key:"dueDate",label:"Due",render:e=>(0,c.p)(e.dueDate,"en-IQ")},{key:"amount",label:"Amount",render:e=>(0,c.y)(e.amount,"en-IQ")},{key:"status",label:"Status",render:e=>s.jsx("span",{className:"px-2 py-0.5 rounded-full border text-xs "+("paid"===e.status?"bg-green-100 text-green-700 border-green-200":"overdue"===e.status?"bg-red-100 text-red-700 border-red-200":"bg-yellow-100 text-yellow-800 border-yellow-200"),children:e.status.toUpperCase()})},{key:"id",label:"Actions",width:"160px",render:e=>s.jsx("div",{className:"flex gap-2",children:"paid"!==e.status?s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border",onClick:()=>w(e.id),children:"Mark Paid"}):null})}],rows:S,selectable:!0,selected:f,onToggleRow:e=>k(t=>({...t,[String(e.id)]:!t[String(e.id)]})),onToggleAll:e=>{let t={};e&&S.forEach(e=>t[String(e.id)]=!0),k(t)}}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-3",children:[s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:0===g,onClick:()=>h(e=>Math.max(0,e-1)),children:"Prev"}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:!y,onClick:()=>h(e=>e+1),children:"Next"})]}),x?s.jsx("div",{className:"mt-2 text-sm opacity-70",children:"Loading…"}):null]})})}},6855:(e,t,r)=>{"use strict";r.d(t,{w:()=>a});var s=r(326),n=r(7577);function a({columns:e,rows:t,selectable:r,selected:a,onToggleRow:i,onToggleAll:l}){let[d,o]=(0,n.useState)(null),[c,u]=(0,n.useState)("asc"),p=(0,n.useMemo)(()=>{if(!d)return t;let e=[...t];return e.sort((e,t)=>{let r=e[d],s=t[d];return r<s?"asc"===c?-1:1:r>s?"asc"===c?1:-1:0}),e},[t,d,c]),m=({active:e})=>s.jsx("span",{className:"ml-1 text-xs opacity-70",children:e?"asc"===c?"↑":"↓":"↕"}),x=r&&a&&t.length>0&&t.every(e=>a[String(e.id)]);return r&&a&&t.some(e=>a[String(e.id)]),s.jsx("div",{className:"overflow-x-auto rounded-lg border border-border",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{className:"bg-muted/40 sticky top-0 z-10 backdrop-blur",children:(0,s.jsxs)("tr",{children:[r?s.jsx("th",{className:"p-3 w-[42px]",children:s.jsx("input",{type:"checkbox","aria-label":"Select all rows",checked:!!x,onChange:e=>l?.(e.target.checked)})}):null,e.map(e=>(0,s.jsxs)("th",{className:"text-left p-3 cursor-pointer select-none",style:{width:e.width},onClick:()=>{var t;d===(t=e.key)?u(e=>"asc"===e?"desc":"asc"):(o(t),u("asc"))},children:[e.label,s.jsx(m,{active:d===e.key})]},String(e.key)))]})}),s.jsx("tbody",{className:"bg-card",children:p.map((t,n)=>(0,s.jsxs)("tr",{className:"border-t border-border transition-colors "+(n%2==1?"bg-muted/10 ":"")+(r&&a&&a[String(t.id)]?" bg-primary/5 ":"")+"hover:bg-muted/20",children:[r?s.jsx("td",{className:"p-3 w-[42px]",children:s.jsx("input",{type:"checkbox","aria-label":`Select row ${String(t.id)}`,checked:!!a?.[String(t.id)],onChange:()=>i?.(t)})}):null,e.map(e=>s.jsx("td",{className:"p-3",children:e.render?e.render(t):t[e.key]},String(e.key)))]},String(t.id)))})]})})}},8131:(e,t,r)=>{"use strict";r.d(t,{j:()=>n});var s=r(326);function n({filename:e,columns:t,rows:r}){return s.jsx("button",{className:"rounded-md border border-border px-3 py-2 text-sm",onClick:function(){let s=new Blob([t.map(e=>a(String(e.label))).join(",")+"\n"+r.map(e=>t.map(t=>{var r;return a(null==(r=e[t.key])?"":r instanceof Date?r.toISOString():String(r))}).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=e,i.click(),URL.revokeObjectURL(n)},title:"Export CSV",children:"Export CSV"})}function a(e){return e.includes(",")||e.includes('"')||e.includes("\n")?'"'+e.replace(/"/g,'""')+'"':e}r(7577)},3971:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var s=r(326);function n({query:e,setQuery:t,onSearch:r,right:n}){return(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("input",{className:"w-full md:w-auto flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"Search…",value:e,onChange:e=>t(e.target.value)}),s.jsx("button",{className:"rounded-md bg-primary text-primaryForeground px-3 py-2 text-sm",onClick:r,children:"Search"}),n]})}r(7577)},72:(e,t,r)=>{"use strict";function s(e,t="en-IQ"){return new Intl.NumberFormat(t,{style:"currency",currency:"IQD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function n(e,t="ar-IQ"){let r="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat(t,{year:"numeric",month:"2-digit",day:"2-digit",timeZone:"UTC"}).format(r)}r.d(t,{p:()=>n,y:()=>s})},9661:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`C:\Users\pc\Desktop\installments-app\admin-web\app\(routes)\installments\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[148,434,399],()=>r(2703));module.exports=s})();
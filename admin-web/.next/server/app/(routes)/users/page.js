(()=>{var e={};e.id=109,e.ids=[109],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},543:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),t(7814),t(5866),t(5252);var s=t(3191),n=t(8716),a=t(7922),i=t.n(a),o=t(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let d=["",{children:["(routes)",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7814)),"C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\(routes)\\users\\page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,5252)),"C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\(routes)\\users\\page.tsx"],u="/(routes)/users/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(routes)/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9196:(e,r,t)=>{Promise.resolve().then(t.bind(t,7098))},7098:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(326),n=t(7577),a=t(9748),i=t(3971),o=t(6855),l=t(3055),d=t(8131);function c(){let[e,r]=(0,n.useState)(""),[t,c]=(0,n.useState)([]),[p,m]=(0,n.useState)(!0),[x,b]=(0,n.useState)(0),[h,g]=(0,n.useState)(!1),[j,y]=(0,n.useState)({}),f=(0,n.useMemo)(()=>{let r=e.toLowerCase().trim();return r?t.filter(e=>e.id.toLowerCase().includes(r)||e.role.toLowerCase().includes(r)):t},[t,e]),v=(0,n.useMemo)(()=>f.filter(e=>j[String(e.id)]),[f,j]);async function k(e,r){await l.O.from("user_roles").upsert({user_id:e,role:r}),c(t=>t.map(t=>t.id===e?{...t,role:r}:t))}async function N(e){await l.O.from("user_roles").delete().eq("user_id",e),c(r=>r.filter(r=>r.id!==e))}async function S(e){let r=v.map(e=>e.id);r.length&&(await l.O.from("user_roles").upsert(r.map(r=>({user_id:r,role:e}))),c(t=>t.map(t=>r.includes(t.id)?{...t,role:e}:t)),y({}))}async function w(){let e=v.map(e=>e.id);e.length&&(await l.O.from("user_roles").delete().in("user_id",e),c(r=>r.filter(r=>!e.includes(r.id))),y({}))}function C(e){return"admin"===e?"manager":"manager"===e?"client":"admin"}return(0,s.jsxs)(a.N,{children:[s.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Users"}),s.jsx(i.o,{query:e,setQuery:r,onSearch:()=>{},right:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(d.j,{filename:"users.csv",columns:[{key:"email",label:"Email"},{key:"role",label:"Role"}],rows:v.length?v:f}),(0,s.jsxs)("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:0===v.length,onClick:()=>S("manager"),children:["Make Manager (",v.length,")"]}),(0,s.jsxs)("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:0===v.length,onClick:w,children:["Remove (",v.length,")"]}),s.jsx(u,{onInvited:()=>window.location.reload()})]})}),s.jsx(o.w,{columns:[{key:"email",label:"Email",render:e=>e.email||e.id},{key:"role",label:"Role",width:"140px",render:e=>s.jsx("span",{className:"inline-flex rounded-full border border-border px-2 py-0.5 text-xs bg-muted/30",children:e.role.toUpperCase()})},{key:"id",label:"Actions",width:"260px",render:e=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{className:"px-3 py-1.5 rounded-md border border-border",onClick:()=>k(e.id,C(e.role)),children:["Make ",C(e.role)]}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border",onClick:()=>N(e.id),children:"Remove"})]})}],rows:f,selectable:!0,selected:j,onToggleRow:e=>y(r=>({...r,[String(e.id)]:!r[String(e.id)]})),onToggleAll:e=>{let r={};e&&f.forEach(e=>r[String(e.id)]=!0),y(r)}}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-3",children:[s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:0===x,onClick:()=>b(e=>Math.max(0,e-1)),children:"Prev"}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:!h,onClick:()=>b(e=>e+1),children:"Next"})]}),p?s.jsx("div",{className:"mt-2 text-sm opacity-70",children:"Loading…"}):null]})}function u({onInvited:e}){let[r,t]=(0,n.useState)(!1),[a,i]=(0,n.useState)(""),[o,l]=(0,n.useState)("client");async function d(){(await fetch("http://localhost:3001/auth/invite",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({email:a,role:o})})).ok&&(t(!1),e())}return(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{className:"rounded-md bg-primary text-primaryForeground px-3 py-2 text-sm",onClick:()=>t(!0),children:"Invite"}),r?s.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:()=>t(!1),children:(0,s.jsxs)("div",{className:"absolute right-4 top-16 bg-card border border-border rounded-md p-4 w-[320px]",onClick:e=>e.stopPropagation(),children:[s.jsx("div",{className:"text-sm font-semibold mb-2",children:"Invite user"}),(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("input",{className:"rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"email@example.com",value:a,onChange:e=>i(e.target.value)}),(0,s.jsxs)("select",{className:"rounded-md border border-input bg-background px-3 py-2 text-sm",value:o,onChange:e=>l(e.target.value),children:[s.jsx("option",{value:"client",children:"Client"}),s.jsx("option",{value:"manager",children:"Manager"}),s.jsx("option",{value:"accountant",children:"Accountant"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border",onClick:()=>t(!1),children:"Cancel"}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border",onClick:d,children:"Send Invite"})]})]})]})}):null]})}},6855:(e,r,t)=>{"use strict";t.d(r,{w:()=>a});var s=t(326),n=t(7577);function a({columns:e,rows:r,selectable:t,selected:a,onToggleRow:i,onToggleAll:o}){let[l,d]=(0,n.useState)(null),[c,u]=(0,n.useState)("asc"),p=(0,n.useMemo)(()=>{if(!l)return r;let e=[...r];return e.sort((e,r)=>{let t=e[l],s=r[l];return t<s?"asc"===c?-1:1:t>s?"asc"===c?1:-1:0}),e},[r,l,c]),m=({active:e})=>s.jsx("span",{className:"ml-1 text-xs opacity-70",children:e?"asc"===c?"↑":"↓":"↕"}),x=t&&a&&r.length>0&&r.every(e=>a[String(e.id)]);return t&&a&&r.some(e=>a[String(e.id)]),s.jsx("div",{className:"overflow-x-auto rounded-lg border border-border",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{className:"bg-muted/40 sticky top-0 z-10 backdrop-blur",children:(0,s.jsxs)("tr",{children:[t?s.jsx("th",{className:"p-3 w-[42px]",children:s.jsx("input",{type:"checkbox","aria-label":"Select all rows",checked:!!x,onChange:e=>o?.(e.target.checked)})}):null,e.map(e=>(0,s.jsxs)("th",{className:"text-left p-3 cursor-pointer select-none",style:{width:e.width},onClick:()=>{var r;l===(r=e.key)?u(e=>"asc"===e?"desc":"asc"):(d(r),u("asc"))},children:[e.label,s.jsx(m,{active:l===e.key})]},String(e.key)))]})}),s.jsx("tbody",{className:"bg-card",children:p.map((r,n)=>(0,s.jsxs)("tr",{className:"border-t border-border transition-colors "+(n%2==1?"bg-muted/10 ":"")+(t&&a&&a[String(r.id)]?" bg-primary/5 ":"")+"hover:bg-muted/20",children:[t?s.jsx("td",{className:"p-3 w-[42px]",children:s.jsx("input",{type:"checkbox","aria-label":`Select row ${String(r.id)}`,checked:!!a?.[String(r.id)],onChange:()=>i?.(r)})}):null,e.map(e=>s.jsx("td",{className:"p-3",children:e.render?e.render(r):r[e.key]},String(e.key)))]},String(r.id)))})]})})}},8131:(e,r,t)=>{"use strict";t.d(r,{j:()=>n});var s=t(326);function n({filename:e,columns:r,rows:t}){return s.jsx("button",{className:"rounded-md border border-border px-3 py-2 text-sm",onClick:function(){let s=new Blob([r.map(e=>a(String(e.label))).join(",")+"\n"+t.map(e=>r.map(r=>{var t;return a(null==(t=e[r.key])?"":t instanceof Date?t.toISOString():String(t))}).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=e,i.click(),URL.revokeObjectURL(n)},title:"Export CSV",children:"Export CSV"})}function a(e){return e.includes(",")||e.includes('"')||e.includes("\n")?'"'+e.replace(/"/g,'""')+'"':e}t(7577)},3971:(e,r,t)=>{"use strict";t.d(r,{o:()=>n});var s=t(326);function n({query:e,setQuery:r,onSearch:t,right:n}){return(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("input",{className:"w-full md:w-auto flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"Search…",value:e,onChange:e=>r(e.target.value)}),s.jsx("button",{className:"rounded-md bg-primary text-primaryForeground px-3 py-2 text-sm",onClick:t,children:"Search"}),n]})}t(7577)},7814:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(8570).createProxy)(String.raw`C:\Users\pc\Desktop\installments-app\admin-web\app\(routes)\users\page.tsx#default`)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[148,434,399],()=>t(543));module.exports=s})();
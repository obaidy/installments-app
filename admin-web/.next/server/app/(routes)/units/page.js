(()=>{var e={};e.id=545,e.ids=[545],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},9650:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>o}),r(3967),r(5866),r(5252);var s=r(3191),n=r(8716),a=r(7922),i=r.n(a),l=r(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(t,d);let o=["",{children:["(routes)",{children:["units",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3967)),"C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\(routes)\\units\\page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,5252)),"C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\pc\\Desktop\\installments-app\\admin-web\\app\\(routes)\\units\\page.tsx"],u="/(routes)/units/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(routes)/units/page",pathname:"/units",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},8430:(e,t,r)=>{Promise.resolve().then(r.bind(r,7718))},7718:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(326),n=r(7577),a=r(9748),i=r(3971),l=r(6855),d=r(1479),o=r(3055),c=r(8131);function u(){let[e,t]=(0,n.useState)(""),[r,u]=(0,n.useState)([]),[m,p]=(0,n.useState)(!0),[x,b]=(0,n.useState)(0),[h,g]=(0,n.useState)(!1),[j,f]=(0,n.useState)([]),[y,v]=(0,n.useState)(!1),[N,k]=(0,n.useState)(""),[S,w]=(0,n.useState)(""),[C,_]=(0,n.useState)(null),[P,q]=(0,n.useState)({}),[U,E]=(0,n.useState)("");async function O(e){p(!0);let t=50*e,[{data:r},{data:s}]=await Promise.all([o.O.from("units").select("id, name, complex_id, complexes(name)").order("name").range(t,t+50-1),o.O.from("complexes").select("id, name").order("name")]);u((r||[]).map(e=>({id:e.id,name:e.name,complex_id:e.complex_id,complex:e.complexes?.name}))),f(s||[]),g(50===(r||[]).length),p(!1)}let A=(0,n.useMemo)(()=>{let t=e.toLowerCase().trim();return t?r.filter(e=>e.name.toLowerCase().includes(t)||(e.complex||"").toLowerCase().includes(t)):r},[r,e]),L=(0,n.useMemo)(()=>A.filter(e=>P[String(e.id)]),[A,P]);async function D(){E("");let e="number"==typeof S?S:S?Number(S):NaN;if(!N.trim()||!e||Number.isNaN(e)){E("Please enter a name and select a complex.");return}try{if(C){let{error:t}=await o.O.from("units").update({name:N.trim(),complex_id:e}).eq("id",C);if(t)throw t;await O(x)}else{let{data:t,error:r}=await o.O.from("units").insert({name:N.trim(),complex_id:e}).select("id").single();if(r)throw r;t&&u(r=>[{id:t.id,name:N.trim(),complex_id:e,complex:j.find(t=>t.id===e)?.name},...r])}v(!1),_(null)}catch(e){E(e?.message||"Failed to save unit")}}async function M(e){await o.O.from("units").delete().eq("id",e),u(t=>t.filter(t=>t.id!==e))}async function R(){let e=L.map(e=>e.id);e.length&&(await o.O.from("units").delete().in("id",e),u(t=>t.filter(t=>!e.includes(t.id))),q({}))}return(0,s.jsxs)(a.N,{children:[s.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Units"}),s.jsx(i.o,{query:e,setQuery:t,onSearch:()=>{},right:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(c.j,{filename:"units.csv",columns:[{key:"name",label:"Name"},{key:"complex",label:"Complex"}],rows:L.length?L:A}),(0,s.jsxs)("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:0===L.length,onClick:R,children:["Delete Selected (",L.length,")"]}),s.jsx("button",{className:"rounded-md bg-primary text-primaryForeground px-3 py-2 text-sm",onClick:()=>{_(null),k(""),w(""),v(!0)},children:"Add Unit"})]})}),s.jsx(l.w,{columns:[{key:"name",label:"Name"},{key:"complex",label:"Complex"},{key:"id",label:"Actions",width:"200px",render:e=>(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border",onClick:()=>{_(e.id),k(e.name),w(e.complex_id||""),v(!0)},children:"Edit"}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border",onClick:()=>M(e.id),children:"Delete"})]})}],rows:A,selectable:!0,selected:P,onToggleRow:e=>q(t=>({...t,[String(e.id)]:!t[String(e.id)]})),onToggleAll:e=>{let t={};e&&A.forEach(e=>t[String(e.id)]=!0),q(t)}}),m?s.jsx("div",{className:"mt-2 text-sm opacity-70",children:"Loading…"}):null,(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-3",children:[s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:0===x,onClick:()=>b(e=>Math.max(0,e-1)),children:"Prev"}),s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border disabled:opacity-50",disabled:!h,onClick:()=>b(e=>e+1),children:"Next"})]}),(0,s.jsxs)(d.u,{open:y,onClose:()=>v(!1),title:C?"Edit Unit":"Add Unit",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[s.jsx("label",{className:"text-sm",children:"Name"}),s.jsx("input",{className:"rounded-md border border-input bg-background px-3 py-2 text-sm",value:N,onChange:e=>k(e.target.value)}),s.jsx("label",{className:"text-sm",children:"Complex"}),(0,s.jsxs)("select",{className:"rounded-md border border-input bg-background px-3 py-2 text-sm",value:S,onChange:e=>{let t=e.target.value;w(t?Number(t):"")},children:[s.jsx("option",{value:"",children:"Select…"}),j.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),U?s.jsx("div",{className:"text-red-600 text-sm mt-1",children:U}):null]}),s.jsx("div",{className:"mt-3 flex justify-end",children:s.jsx("button",{className:"rounded-md bg-primary text-primaryForeground px-3 py-2 text-sm",onClick:D,children:"Save"})})]})]})}},6855:(e,t,r)=>{"use strict";r.d(t,{w:()=>a});var s=r(326),n=r(7577);function a({columns:e,rows:t,selectable:r,selected:a,onToggleRow:i,onToggleAll:l}){let[d,o]=(0,n.useState)(null),[c,u]=(0,n.useState)("asc"),m=(0,n.useMemo)(()=>{if(!d)return t;let e=[...t];return e.sort((e,t)=>{let r=e[d],s=t[d];return r<s?"asc"===c?-1:1:r>s?"asc"===c?1:-1:0}),e},[t,d,c]),p=({active:e})=>s.jsx("span",{className:"ml-1 text-xs opacity-70",children:e?"asc"===c?"↑":"↓":"↕"}),x=r&&a&&t.length>0&&t.every(e=>a[String(e.id)]);return r&&a&&t.some(e=>a[String(e.id)]),s.jsx("div",{className:"overflow-x-auto rounded-lg border border-border",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{className:"bg-muted/40 sticky top-0 z-10 backdrop-blur",children:(0,s.jsxs)("tr",{children:[r?s.jsx("th",{className:"p-3 w-[42px]",children:s.jsx("input",{type:"checkbox","aria-label":"Select all rows",checked:!!x,onChange:e=>l?.(e.target.checked)})}):null,e.map(e=>(0,s.jsxs)("th",{className:"text-left p-3 cursor-pointer select-none",style:{width:e.width},onClick:()=>{var t;d===(t=e.key)?u(e=>"asc"===e?"desc":"asc"):(o(t),u("asc"))},children:[e.label,s.jsx(p,{active:d===e.key})]},String(e.key)))]})}),s.jsx("tbody",{className:"bg-card",children:m.map((t,n)=>(0,s.jsxs)("tr",{className:"border-t border-border transition-colors "+(n%2==1?"bg-muted/10 ":"")+(r&&a&&a[String(t.id)]?" bg-primary/5 ":"")+"hover:bg-muted/20",children:[r?s.jsx("td",{className:"p-3 w-[42px]",children:s.jsx("input",{type:"checkbox","aria-label":`Select row ${String(t.id)}`,checked:!!a?.[String(t.id)],onChange:()=>i?.(t)})}):null,e.map(e=>s.jsx("td",{className:"p-3",children:e.render?e.render(t):t[e.key]},String(e.key)))]},String(t.id)))})]})})}},8131:(e,t,r)=>{"use strict";r.d(t,{j:()=>n});var s=r(326);function n({filename:e,columns:t,rows:r}){return s.jsx("button",{className:"rounded-md border border-border px-3 py-2 text-sm",onClick:function(){let s=new Blob([t.map(e=>a(String(e.label))).join(",")+"\n"+r.map(e=>t.map(t=>{var r;return a(null==(r=e[t.key])?"":r instanceof Date?r.toISOString():String(r))}).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=e,i.click(),URL.revokeObjectURL(n)},title:"Export CSV",children:"Export CSV"})}function a(e){return e.includes(",")||e.includes('"')||e.includes("\n")?'"'+e.replace(/"/g,'""')+'"':e}r(7577)},3971:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var s=r(326);function n({query:e,setQuery:t,onSearch:r,right:n}){return(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("input",{className:"w-full md:w-auto flex-1 rounded-md border border-input bg-background px-3 py-2 text-sm",placeholder:"Search…",value:e,onChange:e=>t(e.target.value)}),s.jsx("button",{className:"rounded-md bg-primary text-primaryForeground px-3 py-2 text-sm",onClick:r,children:"Search"}),n]})}r(7577)},1479:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});var s=r(326);function n({open:e,onClose:t,title:r,children:n}){return e?(0,s.jsxs)("div",{className:"fixed inset-0 z-40 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:t}),(0,s.jsxs)("div",{className:"relative z-10 w-full max-w-md rounded-lg border border-border bg-card p-4 shadow-card",children:[r?s.jsx("div",{className:"text-lg font-semibold mb-2",children:r}):null,s.jsx("div",{className:"space-y-3",children:n}),s.jsx("div",{className:"mt-4 flex justify-end gap-2",children:s.jsx("button",{className:"px-3 py-1.5 rounded-md border border-border",onClick:t,children:"Close"})})]})]}):null}r(7577)},3967:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`C:\Users\pc\Desktop\installments-app\admin-web\app\(routes)\units\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[148,434,399],()=>r(9650));module.exports=s})();